

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Utils &mdash; EQcorrscan 0.1.1-alpha documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/EQcorrscan_logo.ico"/>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="EQcorrscan 0.1.1-alpha documentation" href="index.html"/>
        <link rel="next" title="Par" href="par.html"/>
        <link rel="prev" title="Core" href="core.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html" class="fa fa-home"> EQcorrscan</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction to the EQcorrscan package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">EQcorrscan tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">Core</a><ul>
<li class="toctree-l2"><a class="reference internal" href="core.html#module-bright_lights">bright_lights</a></li>
<li class="toctree-l2"><a class="reference internal" href="core.html#module-template_gen">template_gen</a></li>
<li class="toctree-l2"><a class="reference internal" href="core.html#module-match_filter">match_filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="core.html#module-lag_calc">lag_calc</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Utils</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-Sfile_util">Sfile_util</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-findpeaks">findpeaks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-clustering">clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pre_processing">pre_processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-EQcorrscan_plotting">EQcorrscan_plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mag_calc">mag_calc</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-stacking">stacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-catalogue2DD">catalogue2DD</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="par.html">Par</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">EQcorrscan</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Utils</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/utils.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="utils">
<h1>Utils<a class="headerlink" href="#utils" title="Permalink to this headline">¶</a></h1>
<p>Codes to run basic utility functions for integration with seisan and to
find peaks in noisy data.</p>
<div class="section" id="module-Sfile_util">
<span id="sfile-util"></span><h2>Sfile_util<a class="headerlink" href="#module-Sfile_util" title="Permalink to this headline">¶</a></h2>
<p>Part of the EQcorrscan module to read nordic format s-files and write them
EQcorrscan is a python module designed to run match filter routines for
seismology, within it are routines for integration to seisan and obspy.
With obspy integration (which is necessary) all main waveform formats can be
read in and output.</p>
<p>Code generated by Calum John Chamberlain of Victoria University of Wellington,
2015.</p>
<p>All rights reserved.</p>
<dl class="class">
<dt id="Sfile_util.PICK">
<em class="property">class </em><code class="descclassname">Sfile_util.</code><code class="descname">PICK</code><span class="sig-paren">(</span><em>station</em>, <em>channel</em>, <em>impulsivity</em>, <em>phase</em>, <em>weight</em>, <em>polarity</em>, <em>time</em>, <em>coda</em>, <em>amplitude</em>, <em>peri</em>, <em>azimuth</em>, <em>velocity</em>, <em>AIN</em>, <em>SNR</em>, <em>azimuthres</em>, <em>timeres</em>, <em>finalweight</em>, <em>distance</em>, <em>CAZ</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Sfile_util.html#PICK"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Sfile_util.PICK" title="Permalink to this definition">¶</a></dt>
<dd><p>Pick information for seisan implimentation</p>
</dd></dl>

<dl class="function">
<dt id="Sfile_util.blanksfile">
<code class="descclassname">Sfile_util.</code><code class="descname">blanksfile</code><span class="sig-paren">(</span><em>wavefile</em>, <em>evtype</em>, <em>userID</em>, <em>outdir</em>, <em>overwrite=False</em>, <em>evtime=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Sfile_util.html#blanksfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Sfile_util.blanksfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Module to generate an empty s-file with a populated header for a given
waveform.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>wavefile</strong> (<em>String</em>) &#8211; Wavefile to associate with this S-file, the timing of the
S-file will be taken from this file if evtime is not set</li>
<li><strong>evtype</strong> (<em>String</em>) &#8211; L,R,D</li>
<li><strong>userID</strong> (<em>String</em>) &#8211; 4-charectar SEISAN USER ID</li>
<li><strong>outdir</strong> (<em>String</em>) &#8211; Location to write S-file</li>
<li><strong>overwrite</strong> (<em>Bool</em>) &#8211; Overwrite an existing S-file, default=False</li>
<li><strong>evtime</strong> (<em>UTCDateTime</em>) &#8211; If given this will set the timing of the S-file</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">String, S-file name</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Sfile_util.populateSfile">
<code class="descclassname">Sfile_util.</code><code class="descname">populateSfile</code><span class="sig-paren">(</span><em>sfilename</em>, <em>picks</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Sfile_util.html#populateSfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Sfile_util.populateSfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Module to populate a blank nordic format S-file with pick information,
arguments required are the filename of the blank s-file and the picks
where picks is a dictionary of picks including station, channel,
impulsivity, phase, weight, polarity, time, coda, amplitude, peri, azimuth,
velocity, SNR, azimuth residual, Time-residual, final weight,
epicentral distance &amp; azimuth from event to station.</p>
<p>This is a full pick line information from the seisan manual, P. 341</p>
</dd></dl>

<dl class="function">
<dt id="Sfile_util.readpicks">
<code class="descclassname">Sfile_util.</code><code class="descname">readpicks</code><span class="sig-paren">(</span><em>sfilename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Sfile_util.html#readpicks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Sfile_util.readpicks" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to read pick informaiton from the s-file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Sfile_tile.PICK</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Sfile_util.readwavename">
<code class="descclassname">Sfile_util.</code><code class="descname">readwavename</code><span class="sig-paren">(</span><em>sfilename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Sfile_util.html#readwavename"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Sfile_util.readwavename" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function to extract the waveform filename from the s-file,
returns a list of waveform names found in the s-file as multiples can
be present.</p>
</dd></dl>

</div>
<div class="section" id="module-findpeaks">
<span id="findpeaks"></span><h2>findpeaks<a class="headerlink" href="#module-findpeaks" title="Permalink to this headline">¶</a></h2>
<p>Function to find peaks in data above a certain threshold as part of the EQcorr
package written by Calum Chamberlain of Victoria University of Wellington in
early 2015.</p>
<dl class="function">
<dt id="findpeaks.find_peaks">
<code class="descclassname">findpeaks.</code><code class="descname">find_peaks</code><span class="sig-paren">(</span><em>arr</em>, <em>thresh</em>, <em>trig_int</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/findpeaks.html#find_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#findpeaks.find_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to determine peaks in an array of data above a certain threshold.</p>
<p>EXPERIMENTAL CODE, DOES NOT WORK EFFICIENTLY, RECOMEND USING find_peaks2</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr</strong> (<em>ndarray</em>) &#8211; 1-D numpy array is required</li>
<li><strong>thresh</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; The threshold below which will be considered noise and peaks    will not be found in.</li>
<li><strong>trig_int</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The minimum difference in samples between triggers,    if multiple peaks within this window this code will find the highest.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">peaks, locs: Lists of peak values and locations.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="findpeaks.find_peaks2">
<code class="descclassname">findpeaks.</code><code class="descname">find_peaks2</code><span class="sig-paren">(</span><em>arr</em>, <em>thresh</em>, <em>trig_int</em>, <em>debug=0</em>, <em>starttime=UTCDateTime(1970</em>, <em>1</em>, <em>1</em>, <em>0</em>, <em>0)</em>, <em>samp_rate=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/findpeaks.html#find_peaks2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#findpeaks.find_peaks2" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to determine peaks in an array of data above a certain threshold.
Improvement on find_peaks, speed-up of approx 250x.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr</strong> (<em>ndarray</em>) &#8211; 1-D numpy array is required</li>
<li><strong>thresh</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; The threshold below which will be considered noise and peaks    will not be found in.</li>
<li><strong>trig_int</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The minimum difference in samples between triggers,    if multiple peaks within this window this code will find the highest.</li>
<li><strong>debug</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Optional, debug level 0-5</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">peaks, locs: Lists of peak values and locations.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-clustering">
<span id="clustering"></span><h2>clustering<a class="headerlink" href="#module-clustering" title="Permalink to this headline">¶</a></h2>
<p>Code to compute the linkage between seismograms and cluster them accordingly</p>
<p>Written by Calum Chamberlain, in alpha stages of development as of 24/06/2015</p>
<p>Implimented to streamline templates after template detection in beamforming
methods, employed by implimentation of Frank et al. code.</p>
<p>As such this code is designed to work only for templates with the same channels</p>
<dl class="function">
<dt id="clustering.SVD_2_stream_testing">
<code class="descclassname">clustering.</code><code class="descname">SVD_2_stream_testing</code><span class="sig-paren">(</span><em>SVectors</em>, <em>stachans</em>, <em>k</em>, <em>sampling_rate</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clustering.html#SVD_2_stream_testing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clustering.SVD_2_stream_testing" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to convert the singular vectors output by SVD to streams, one for
each singular vector level, for all channels.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>SVectors</strong> (<em>ndarray</em>) &#8211; Singular vectors</li>
<li><strong>stachans</strong> (<em>List of Strings</em>) &#8211; List of station.channel Strings</li>
<li><strong>k</strong> (<em>Int</em>) &#8211; Number of streams to return = number of SV&#8217;s to include</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Sampling_rate:</th><td class="field-body"><p class="first">Float</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">SVstreams, List of Obspy.Stream, with SVStreams[0] being
composed of the highest rank singular vectors.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Note</p>
<p><strong>IN ALPHA, not working as expected</strong></p>
</dd></dl>

<dl class="function">
<dt id="clustering.SVD_testing">
<code class="descclassname">clustering.</code><code class="descname">SVD_testing</code><span class="sig-paren">(</span><em>templates</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clustering.html#SVD_testing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clustering.SVD_testing" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute the SVD of a number of templates and return the singular
vectors and singular values of the templates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>templates</strong> (<em>List of Obspy.Stream</em>) &#8211; List of the templates to be analysed</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">SVector(ndarray), SValues(ndarray) for each channel, stachans, List
of String (station.channel)</td>
</tr>
</tbody>
</table>
<p class="rubric">Note</p>
<p><strong>IN ALPHA, not working as expected</strong></p>
<p>It is recommended that you align the data before computing the SVD, .e.g.,
the P-arrival on all templates for the same channel should appear at the same
time in the trace.</p>
</dd></dl>

<dl class="function">
<dt id="clustering.allign_traces">
<code class="descclassname">clustering.</code><code class="descname">allign_traces</code><span class="sig-paren">(</span><em>traces</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clustering.html#allign_traces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clustering.allign_traces" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to allign all traces in a stream based on their cross-correlations</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>traces</strong> (<em>List of :class: obspy.Trace</em>) &#8211; List of of single channels unalligned - should contain            data from multiple earthquakes for a single site, channel and phase            I will compute the linear stack of all traces and allign the traces            relative to this.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="clustering.cluster">
<code class="descclassname">clustering.</code><code class="descname">cluster</code><span class="sig-paren">(</span><em>templates</em>, <em>show=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clustering.html#cluster"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clustering.cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to take a set of templates and cluster them, will return clustered
templates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">List of cluster groups, array of length len(templates), with
each number relating to a cluster</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="clustering.cross_chan_coherance">
<code class="descclassname">clustering.</code><code class="descname">cross_chan_coherance</code><span class="sig-paren">(</span><em>st1</em>, <em>st2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clustering.html#cross_chan_coherance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clustering.cross_chan_coherance" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to determine the cross-channel coherancy between two streams of
multichannel seismic data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">cross channel coherance, float - normalized by number of channels</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="clustering.distance_matrix">
<code class="descclassname">clustering.</code><code class="descname">distance_matrix</code><span class="sig-paren">(</span><em>templates</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clustering.html#distance_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clustering.distance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute the distance matrix for all templates - will give
distance as 1-abs(cccoh), e.g. a well correlated pair of templates will
have small distances, and an equally well correlated reverse image will
have the same distance as apositively correlated image - this is an issue</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">ndarray - distance matrix</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="clustering.group_delays">
<code class="descclassname">clustering.</code><code class="descname">group_delays</code><span class="sig-paren">(</span><em>templates</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clustering.html#group_delays"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clustering.group_delays" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to group template waveforms according to their delays</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>templates</strong> (<em>List of obspy.Stream</em>) &#8211; List of the waveforms you want to group</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of List of obspy.Streams where each initial list is a group
with the same delays</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pre_processing">
<span id="pre-processing"></span><h2>pre_processing<a class="headerlink" href="#module-pre_processing" title="Permalink to this headline">¶</a></h2>
<p>Utilities module for the EQcorrscan package written by Calum Chamberlain of
Victoria University Wlelington.  These functions are designed to do the basic
processing of the data using obspy modules (which also rely on scipy and numpy).</p>
<dl class="function">
<dt id="pre_processing._check_daylong">
<code class="descclassname">pre_processing.</code><code class="descname">_check_daylong</code><span class="sig-paren">(</span><em>tr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pre_processing.html#_check_daylong"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pre_processing._check_daylong" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to check the data quality of the daylong file - check to see that
the day isn&#8217;t just zeros, with large steps, if it is then the resampling will
hate it.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return qual:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pre_processing.dayproc">
<code class="descclassname">pre_processing.</code><code class="descname">dayproc</code><span class="sig-paren">(</span><em>tr</em>, <em>lowcut</em>, <em>highcut</em>, <em>filt_order</em>, <em>samp_rate</em>, <em>debug</em>, <em>starttime</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pre_processing.html#dayproc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pre_processing.dayproc" title="Permalink to this definition">¶</a></dt>
<dd><p>Basic function to bandpass, downsample and check headers and length of trace
to ensure files start at the start of a day and are daylong.  Works in place
on data.  This is employed to ensure all parts of the data are processed
in the same way.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">obspy.Stream</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pre_processing.shortproc">
<code class="descclassname">pre_processing.</code><code class="descname">shortproc</code><span class="sig-paren">(</span><em>st</em>, <em>lowcut</em>, <em>highcut</em>, <em>filt_order</em>, <em>samp_rate</em>, <em>debug=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pre_processing.html#shortproc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pre_processing.shortproc" title="Permalink to this definition">¶</a></dt>
<dd><p>Basic function to bandpass, downsample.  Works in place
on data.  This is employed to ensure all parts of the data are processed
in the same way.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">obspy.Stream</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-EQcorrscan_plotting">
<span id="eqcorrscan-plotting"></span><h2>EQcorrscan_plotting<a class="headerlink" href="#module-EQcorrscan_plotting" title="Permalink to this headline">¶</a></h2>
<p>Utility code for most of the plots used as part of the EQcorrscan package.</p>
<dl class="function">
<dt id="EQcorrscan_plotting.Noise_plotting">
<code class="descclassname">EQcorrscan_plotting.</code><code class="descname">Noise_plotting</code><span class="sig-paren">(</span><em>station</em>, <em>channel</em>, <em>PAZ</em>, <em>datasource</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EQcorrscan_plotting.html#Noise_plotting"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#EQcorrscan_plotting.Noise_plotting" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to make use of obspy&#8217;s PPSD functionality to read in data from
a single station and the poles-and-zeros for that station before plotting
the PPSD for this station.  See McNamara(2004) for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>station</strong> (<em>String</em>) &#8211; Station name as it is in the filenames in the database</li>
<li><strong>channel</strong> (<em>String</em>) &#8211; Channel name as it is in the filenames in the database</li>
<li><strong>PAZ</strong> (<em>Dict</em>) &#8211; Must contain, Poles, Zeros, Sensitivity, Gain
:type Poles: List of Complex
:type Zeros: List of Complex
:type Sensitivity: Float
:type Gain: Float</li>
<li><strong>datasource</strong> (<em>String</em>) &#8211; The directory in which data can be found, can contain
wildcards.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">PPSD object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="EQcorrscan_plotting.cumulative_detections">
<code class="descclassname">EQcorrscan_plotting.</code><code class="descname">cumulative_detections</code><span class="sig-paren">(</span><em>dates</em>, <em>template_names</em>, <em>save=False</em>, <em>savefile=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EQcorrscan_plotting.html#cumulative_detections"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#EQcorrscan_plotting.cumulative_detections" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple plotting function to take a list of UTCDateTime objects and plot
a cumulative detections list.  Can take dates as a list of lists and will
plot each list seperately, e.g. if you have dates from more than one
template it will overlay them in different colours.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dates</strong> (<em>list of lists of datetime.datetime</em>) &#8211; Must be a list of lists of datetime.datetime objects</li>
<li><strong>template_names</strong> (<em>list of strings</em>) &#8211; List of the template names in order of the dates</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="EQcorrscan_plotting.detection_multiplot">
<code class="descclassname">EQcorrscan_plotting.</code><code class="descname">detection_multiplot</code><span class="sig-paren">(</span><em>stream</em>, <em>template</em>, <em>times</em>, <em>streamcolour='k'</em>, <em>templatecolour='r'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EQcorrscan_plotting.html#detection_multiplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#EQcorrscan_plotting.detection_multiplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to plot the stream of data that has been detected in, with the
template on top of it timed according to a list of given times, just a
pretty way to show a detection!</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>stream</strong> (<em>obspy.Stream</em>) &#8211; Stream of data to be plotted as the base (black)</li>
<li><strong>template</strong> (<em>obspy.Stream</em>) &#8211; Template to be plotted on top of the base stream (red)</li>
<li><strong>times</strong> (<em>List of datetime.datetime</em>) &#8211; list of times of detections in the order of the channels in
template.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="EQcorrscan_plotting.detection_timeseries">
<code class="descclassname">EQcorrscan_plotting.</code><code class="descname">detection_timeseries</code><span class="sig-paren">(</span><em>stream</em>, <em>detector</em>, <em>detections</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EQcorrscan_plotting.html#detection_timeseries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#EQcorrscan_plotting.detection_timeseries" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to plot the data and detector with detections labelled in red,
will downsample if too many data points.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>detections</strong> (<em>np.array</em>) &#8211; array of positions of detections in samples</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="EQcorrscan_plotting.peaks_plot">
<code class="descclassname">EQcorrscan_plotting.</code><code class="descname">peaks_plot</code><span class="sig-paren">(</span><em>data, starttime, samp_rate, save=False, peaks=[(0, 0)], savefile=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EQcorrscan_plotting.html#peaks_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#EQcorrscan_plotting.peaks_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple utility code to plot the correlation peaks to check that the peak
finding routine is running correctly, used in debugging for the EQcorrscan
module.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="EQcorrscan_plotting.threeD_gridplot">
<code class="descclassname">EQcorrscan_plotting.</code><code class="descname">threeD_gridplot</code><span class="sig-paren">(</span><em>nodes</em>, <em>save=False</em>, <em>savefile=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EQcorrscan_plotting.html#threeD_gridplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#EQcorrscan_plotting.threeD_gridplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to plot in 3D a series of grid points.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nodes</strong> (<em>List of tuples</em>) &#8211; List of tuples of the form (lat, long, depth)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="EQcorrscan_plotting.threeD_seismplot">
<code class="descclassname">EQcorrscan_plotting.</code><code class="descname">threeD_seismplot</code><span class="sig-paren">(</span><em>stations</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EQcorrscan_plotting.html#threeD_seismplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#EQcorrscan_plotting.threeD_seismplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to plot seismicity and stations in a 3D, movable, zoomable space
using matplotlibs Axes3D package.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>stations</strong> (<em>list of tuple</em>) &#8211; list of one tuple per station of (lat, long, elevation),
with up positive</li>
<li><strong>nodes</strong> (<em>list of tuple</em>) &#8211; list of one tuple per event of (lat, long, depth) with down
positive</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="EQcorrscan_plotting.triple_plot">
<code class="descclassname">EQcorrscan_plotting.</code><code class="descname">triple_plot</code><span class="sig-paren">(</span><em>cccsum</em>, <em>trace</em>, <em>threshold</em>, <em>save=False</em>, <em>savefile=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EQcorrscan_plotting.html#triple_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#EQcorrscan_plotting.triple_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Main function to make a triple plot with a day-long seismogram, day-long
correlation sum trace and histogram of the correlation sum to show normality</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-mag_calc">
<span id="mag-calc"></span><h2>mag_calc<a class="headerlink" href="#module-mag_calc" title="Permalink to this headline">¶</a></h2>
<p>Functions to simulate Wood Anderson traces, pick maximum peak-to-peak amplitudes
write these amplitudes and periods to SEISAN s-files and to calculate magnitudes
from this and the informaiton within SEISAN s-files.</p>
<p>Written as part of the EQcorrscan package by Calum Chamberlain - first written
to impliment magnitudes for the 2015 Wanaka aftershock sequence, written up
by Warren-Smith [2014/15].</p>
<dl class="function">
<dt id="mag_calc.Amp_pick_sfile">
<code class="descclassname">mag_calc.</code><code class="descname">Amp_pick_sfile</code><span class="sig-paren">(</span><em>sfile, datapath, respdir, chans=['Z'], var_wintype=True, winlen=0.9, pre_pick=1.0, pre_filt=True, lowcut=1.0, highcut=20.0, corners=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mag_calc.html#Amp_pick_sfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mag_calc.Amp_pick_sfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to read information from a SEISAN s-file, load the data and the
picks, cut the data for the channels given around the S-window, simulate
a Wood Anderson seismometer, then pick the maximum peak-to-trough
amplitude.</p>
<p>Output will be put into a mag_calc.out file which will be in full S-file
format and can be copied to a REA database.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>datapath</strong> (<em>String</em>) &#8211; Path to the waveform files - usually the path to the WAV directory</li>
<li><strong>respdir</strong> (<em>String</em>) &#8211; Path to the response information directory</li>
<li><strong>chans</strong> (<em>List of strings</em>) &#8211; List of the channels to pick on, defaults to [&#8216;Z&#8217;] - should
just be the orientations, e.g. Z,1,2,N,E</li>
<li><strong>var_wintype</strong> (<em>Bool</em>) &#8211; If True, the winlen will be
multiplied by the P-S time if both P and S picks are
available, otherwise it will be multiplied by the hypocentral
distance*0.34 - dervided using a p-s ratio of 1.68 and
S-velocity of 1.5km/s to give a large window, defaults to True</li>
<li><strong>winlen</strong> (<em>Float</em>) &#8211; Length of window, see above parameter, if var_wintype is False
Then this will be in seconds, otherwise it is the multiplier
to the p-s time, defaults to 0.5</li>
<li><strong>pre_pick</strong> (<em>Float</em>) &#8211; Time before the s-pick to start the cut window, defaults
to 1.0</li>
<li><strong>pre_filt</strong> (<em>Bool</em>) &#8211; To apply a pre-filter or not, defaults to True</li>
<li><strong>lowcut</strong> (<em>Float</em>) &#8211; Lowcut in Hz for the pre-filter, defaults to 1.0</li>
<li><strong>highcut</strong> (<em>Float</em>) &#8211; Highcut in Hz for the pre-filter, defaults to 20.0</li>
<li><strong>corners</strong> (<em>Int</em>) &#8211; Number of corners to use in the pre-filter</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mag_calc._GSE2_PAZ_read">
<code class="descclassname">mag_calc.</code><code class="descname">_GSE2_PAZ_read</code><span class="sig-paren">(</span><em>GSEfile</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mag_calc.html#_GSE2_PAZ_read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mag_calc._GSE2_PAZ_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to read the instrument response information from a GSE Poles and
Zeros file as generated by the SEISAN program RESP.</p>
<p>Format must be CAL2, not coded for any other format at the moment, contact
the author to add others in.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Dict of poles, zeros, gain and sensitivity</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mag_calc._find_resp">
<code class="descclassname">mag_calc.</code><code class="descname">_find_resp</code><span class="sig-paren">(</span><em>station</em>, <em>channel</em>, <em>network</em>, <em>time</em>, <em>delta</em>, <em>directory</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mag_calc.html#_find_resp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mag_calc._find_resp" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to find the response information for a given station and
channel at a given time and return a dictionary of poles and zeros, gain
and sensitivity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>station</strong> (<em>String</em>) &#8211; Station name (as in the response files)</li>
<li><strong>channel</strong> (<em>String</em>) &#8211; Channel name (as in the response files)</li>
<li><strong>network</strong> (<em>String</em>) &#8211; Network to scan for, can be a wildcard</li>
<li><strong>time</strong> (<a class="reference external" href="https://docs.python.org/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><em>datetime.datetime</em></a>) &#8211; Date-time to look for repsonse information</li>
<li><strong>delta</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Sample interval in seconds</li>
<li><strong>direcotry</strong> &#8211; Directory to scan for response information</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Dictionary</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mag_calc._max_p2t">
<code class="descclassname">mag_calc.</code><code class="descname">_max_p2t</code><span class="sig-paren">(</span><em>data</em>, <em>delta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mag_calc.html#_max_p2t"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mag_calc._max_p2t" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to find the maximum peak to trough amplitude and period of this
amplitude.  Originally designed to be used to calculate magnitudes (by
taking half of the peak-to-trough amplitude as the peak amplitude).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>ndarray</em>) &#8211; waveform trace to find the peak-to-trough in.</li>
<li><strong>delta</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Sampling interval in seconds</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">tuple of (amplitude, period, time) with amplitude in the same scale as
given in the input data, and period in seconds, and time in seconds
from the start of the data window.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mag_calc._sim_WA">
<code class="descclassname">mag_calc.</code><code class="descname">_sim_WA</code><span class="sig-paren">(</span><em>trace</em>, <em>PAZ</em>, <em>seedresp</em>, <em>water_level</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mag_calc.html#_sim_WA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mag_calc._sim_WA" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to remove the insturment response from a trace and return a
de-meaned, de-trended, Wood Anderson simulated trace in it&#8217;s place.</p>
<p>Works in-place on data and will destroy your original data, copy the
trace before giving it to this function!</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>trace</strong> (<em>obspy.Trace</em>) &#8211; A standard obspy trace, generally should be given without
pre-filtering, if given with pre-filtering for use with
amplitude determiniation for magnitudes you will need to
worry about how you cope with the response of this filter
yourself.</li>
<li><strong>PAZ</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary containing lists of poles and zeros, the gain and
the sensitivity.</li>
<li><strong>water_level</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Water level for the simulation.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">obspy.Trace</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-stacking">
<span id="stacking"></span><h2>stacking<a class="headerlink" href="#module-stacking" title="Permalink to this headline">¶</a></h2>
<p>Utility module of the EQcorrscan package to allow for different methods of
stacking of seismic signal in one place.</p>
<p>In alpha stages and only with linear stacking implimented thusfar</p>
<p>Calum Chamberlain 24/06/2015</p>
<dl class="function">
<dt id="stacking.PWS_stack">
<code class="descclassname">stacking.</code><code class="descname">PWS_stack</code><span class="sig-paren">(</span><em>streams</em>, <em>weight</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacking.html#PWS_stack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#stacking.PWS_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute the phase weighted stack of a series of streams</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>weight</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Exponent to the phase stack used for weighting.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">obspy.Stream</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stacking.linstack">
<code class="descclassname">stacking.</code><code class="descname">linstack</code><span class="sig-paren">(</span><em>streams</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacking.html#linstack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#stacking.linstack" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute the linear stack of a series of seismic streams of
multiplexed data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">stack - Stream</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-catalogue2DD">
<span id="catalogue2dd"></span><h2>catalogue2DD<a class="headerlink" href="#module-catalogue2DD" title="Permalink to this headline">¶</a></h2>
<p>Module written by Calum Chamberlain as part of the EQcorrscan package.</p>
<p>This module contains functions to convert a seisan catalogue to files ready for
relocation in hypoDD - it will generate both a catalogue (dt.ct) file, event
file (event.dat), station information file (station.dat), and a correlation
oiutput file correlated every event in the catalogue with every other event to
optimize the picks (dt.cc).</p>
<p>The correlation routine relies on obspy&#8217;s xcorrPickCorrection function from the
obspy.signal.cross_correlation module.  This function optimizes picks to better
than sample accuracy by interpolating the correlation function and finding the
maximum of this rather than the true maximum correlation value.  The output
from this function is stored in the dt.cc file.</p>
<p>Information for the station.dat file is read from SEISAN&#8217;s STATION0.HYP file</p>
<p>Earthquake picks and locations are taken from the catalogued s-files - these
must be pre-located before entering this routine as origin times and hypocentre
locations are needed for event.dat files.</p>
<dl class="function">
<dt id="catalogue2DD._av_weight">
<code class="descclassname">catalogue2DD.</code><code class="descname">_av_weight</code><span class="sig-paren">(</span><em>W1</em>, <em>W2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/catalogue2DD.html#_av_weight"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalogue2DD._av_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to convert from two seisan weights (0-4) to one hypoDD weight(0-1)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="catalogue2DD._cc_round">
<code class="descclassname">catalogue2DD.</code><code class="descname">_cc_round</code><span class="sig-paren">(</span><em>num</em>, <em>dp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/catalogue2DD.html#_cc_round"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalogue2DD._cc_round" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function to take a float and round it to dp padding with zeros
to return a string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="catalogue2DD._separation">
<code class="descclassname">catalogue2DD.</code><code class="descname">_separation</code><span class="sig-paren">(</span><em>loc1</em>, <em>loc2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/catalogue2DD.html#_separation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalogue2DD._separation" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to calculate the distance between two points in the earth</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>loc1</strong> (<em>tuple (float, float, float)</em>) &#8211; First point location as lat, long, depth in deg, deg, km</li>
<li><strong>loc2</strong> (<em>tuple (float, float, float)</em>) &#8211; First point location as lat, long, depth in deg, deg, km</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">distance in km (float)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="catalogue2DD.readSTATION0">
<code class="descclassname">catalogue2DD.</code><code class="descname">readSTATION0</code><span class="sig-paren">(</span><em>path</em>, <em>stations</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/catalogue2DD.html#readSTATION0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalogue2DD.readSTATION0" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to read the STATION0.HYP file on the path given.  Outputs written
in station.dat file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<em>String</em>) &#8211; Path to the STATION0.HYP file</li>
<li><strong>station</strong> (<em>List</em>) &#8211; Stations to look for</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">List of tuples of station, lat, long, elevation</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="catalogue2DD.write_catalogue">
<code class="descclassname">catalogue2DD.</code><code class="descname">write_catalogue</code><span class="sig-paren">(</span><em>event_list</em>, <em>max_sep=10</em>, <em>min_link=8</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/catalogue2DD.html#write_catalogue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalogue2DD.write_catalogue" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to write the dt.ct file needed by hypoDD - takes input event list
from write_event as a list of tuples of event id and sfile.  It will read
the pick information from the seisan formated s-file using the Sfile_util
utilities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>event_list</strong> (<em>List of tuple</em>) &#8211; List of tuples of event_id (int) and sfile (String)</li>
<li><strong>max_sep</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Maximum seperation between event pairs in km</li>
<li><strong>min_link</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Minimum links for an event to be paired</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">List stations</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="catalogue2DD.write_correlations">
<code class="descclassname">catalogue2DD.</code><code class="descname">write_correlations</code><span class="sig-paren">(</span><em>event_list</em>, <em>wavbase</em>, <em>extract_len</em>, <em>pre_pick</em>, <em>shift_len</em>, <em>lowcut=1.0</em>, <em>highcut=10.0</em>, <em>max_sep=10</em>, <em>min_link=8</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/catalogue2DD.html#write_correlations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalogue2DD.write_correlations" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to write a dt.cc file for hypoDD input - takes an input list of
events and computes pick refienements by correlation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>event_list</strong> (<em>List of tuple</em>) &#8211; List of tuples of event_id (int) and sfile (String)</li>
<li><strong>wavbase</strong> (<a class="reference external" href="https://docs.python.org/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; Path to the seisan wave directory that the wavefiles in the
S-files are stored</li>
<li><strong>extract_len</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Length in seconds to extract around the pick</li>
<li><strong>pre_pick</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Time before the pick to start the correclation window</li>
<li><strong>shift_len</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Time to allow pick to vary</li>
<li><strong>lowcut</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Lowcut in Hz - default=1.0</li>
<li><strong>highcut</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Highcut in Hz - deafult=10.0</li>
<li><strong>max_sep</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Maximum seperation between event pairs in km</li>
<li><strong>min_link</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Minimum links for an event to be paired</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="catalogue2DD.write_event">
<code class="descclassname">catalogue2DD.</code><code class="descname">write_event</code><span class="sig-paren">(</span><em>sfile_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/catalogue2DD.html#write_event"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalogue2DD.write_event" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to write out an event.dat file of the events</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sfile_list</strong> (<em>List</em>) &#8211; List of s-files to sort and put into the database</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of tuples of event ID (int) and Sfile name</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="par.html" class="btn btn-neutral float-right" title="Par">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="core.html" class="btn btn-neutral" title="Core"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Calum John Chamberlain.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.1-alpha',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>